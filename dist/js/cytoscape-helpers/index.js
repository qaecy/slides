"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function g(s,e=!0,t=1e-4,n=.02){let o=0;function i(){s.nodes().forEach((d,l)=>{const a=d.position(),c=Math.sin(performance.now()*t+l)*n,p=Math.cos(performance.now()*t+l)*n;d.position({x:a.x+c,y:a.y+p})}),o=requestAnimationFrame(i)}o=requestAnimationFrame(i);let r=!0;return e&&r&&s.on("mouseover","node",()=>{cancelAnimationFrame(o),r=!1}),o}var y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},b={},m={};Object.defineProperty(m,"__esModule",{value:!0});function x(s){return s}m.asTypedEventEmitter=x;var h={},E=y&&y.__spreadArrays||function(){for(var s=0,e=0,t=arguments.length;e<t;e++)s+=arguments[e].length;for(var n=Array(s),o=0,e=0;e<t;e++)for(var i=arguments[e],r=0,d=i.length;r<d;r++,o++)n[o]=i[r];return n};Object.defineProperty(h,"__esModule",{value:!0});var L=function(){function s(){var e=this;this.events={},this.maxListeners=1/0,this.emit=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(e.events[t]){for(var i=e.events[t].length,r=Array.from(e.events[t]),d=0,l=r;d<l.length;d++){var a=l[d];a.apply(void 0,n)}return!!i}return!1},this.on=function(t,n){return e.addListener(t,n),e},this.once=function(t,n){var o=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];n.apply(void 0,i),e.removeListener(t,o)};return e.addListener(t,o),e},this.addListener=function(t,n){return t in e.events?e.events[t].push(n):e.events[t]=[n],e.maxListeners!==1/0&&e.maxListeners<=e.events[t].length&&console.warn('Maximum event listeners for "'+t+'" event!'),e},this.removeListener=function(t,n){if(t in e.events){var o=e.events[t].indexOf(n);o!==-1&&e.events[t].splice(o,1)}return e},this.hasListeners=function(t){return e.events[t]&&!!e.events[t].length},this.prependListener=function(t,n){return t in e.events?e.events[t].unshift(n):e.events[t]=[n],e},this.prependOnceListener=function(t,n){var o=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];n.apply(void 0,i),e.removeListener(t,o)};return e.prependListener(t,o),e},this.off=function(t,n){return e.removeListener(t,n)},this.removeAllListeners=function(t){return delete e.events[t],e},this.setMaxListeners=function(t){return e.maxListeners=t,e},this.getMaxListeners=function(){return e.maxListeners},this.listeners=function(t){return E(e.events[t])},this.rawListeners=function(t){return e.events[t]},this.eventNames=function(){return Object.keys(e.events)},this.listenerCount=function(t){return e.events[t]&&e.events[t].length||0}}return s}();h.EventEmitter=L;(function(s){function e(t){for(var n in t)s.hasOwnProperty(n)||(s[n]=t[n])}Object.defineProperty(s,"__esModule",{value:!0}),e(m),e(h)})(b);class ${constructor(e){this._cy=e,this.events=new b.EventEmitter,this._initEventListeners()}_initEventListeners(){var e,t;(e=this._cy.container())==null||e.addEventListener("dragover",n=>{n.preventDefault(),n.stopPropagation();const o=this._getClosestNode(n);o===void 0&&this._lastHoveredNode!==void 0?this.events.emit("fileOverNodeEnd",this._lastHoveredNode):this._lastHoveredNode!==o&&o!==void 0&&this.events.emit("fileOverNodeStart",o),this._lastHoveredNode=o}),(t=this._cy.container())==null||t.addEventListener("drop",n=>{var i;n.preventDefault(),n.stopPropagation();const o=this._getClosestNode(n);if(o!==void 0){const r=(i=n.dataTransfer)==null?void 0:i.files;r!==void 0&&this.events.emit("filesDroppedOnNode",o,r)}})}_getClosestNode(e,t=20){var d,l;if(((d=this._cy)==null?void 0:d.nodes())===void 0)return;const o={x:e.offsetX,y:e.offsetY};let i,r=t;return(l=this._cy)==null||l.nodes().forEach(a=>{const c=this._distance(o,a.renderedPosition());c<r&&(r=c,i=a)}),i}_distance(e,t){const n=t.x-e.x,o=t.y-e.y;return Math.sqrt(n*n+o*o)}}const f={backgroundColor:"#fff",edgeColor:"#0d5be9",edgeFontSize:"5rem",edgeWidth:"3rem",nodeColor:"#03337a",nodeOpacity:"0.9",font:"Poppins",directed:!0},O=(s=f)=>[{selector:"node",style:{label:e=>e.data("label")?e.data("label"):"","text-valign":"center","font-family":s.font,"font-size":"10rem",opacity:s.nodeOpacity,color:"white","text-outline-color":e=>e.data("color")?e.data("color"):s.nodeColor,"text-outline-width":1,"background-color":e=>e.data("color")?e.data("color"):s.nodeColor,width:e=>e.data("size")?e.data("size"):"",height:e=>e.data("size")?e.data("size"):""}},{selector:"edge",style:{label:"data(label)","text-valign":"center","font-family":s.font,"font-size":s.edgeFontSize,color:s.edgeColor,"target-arrow-color":s.edgeColor,"curve-style":"bezier","target-arrow-shape":s.directed?"triangle":"none","line-color":s.edgeColor,width:e=>e.data("width")?e.data("width"):s.edgeWidth,"text-rotation":"autorotate","text-background-opacity":1,"text-background-color":s.backgroundColor,"text-background-padding":4}},{selector:".triple",style:{"background-color":"white","border-color":e=>e.data("color")?e.data("color"):s.nodeColor}},{selector:".literal",style:{shape:"rectangle",width:"label",height:"label",label:e=>e.data("label")?e.data("label"):"",padding:"2rem","border-color":"black","border-width":.3,"background-color":"white","text-outline-width":0,color:"black"}},{selector:".loading",style:{"pie-size":"100%","pie-1-background-color":f.nodeColor,"pie-1-background-size":e=>`${e.data("pct")}%`,"pie-2-background-color":f.edgeColor,"pie-2-background-size":e=>`${100-parseInt(e.data("pct"))}%`,label:e=>`${e.data("pct")}%`,"font-size":"5rem"}}],M={name:"grid",padding:100};function w(s){s.on("dragfree","node",e),s.on("viewport",e);function e(){const t=s.json(),n=[];t.elements.nodes.forEach(o=>{const i={};i.data=o.data,i.position={x:Math.round(o.position.x),y:Math.round(o.position.y)},o.classes&&(i.classes=o.classes),n.push(i)}),console.log(n)}}class C{constructor(e="node-menu"){this.id=e,this.items=[],this.hideAfter=2e3,this.sticky=!1,this.conditionalDisplay=t=>!0,this.positionDef=(t,n)=>{const i=t.renderedBoundingBox().h/2,r=Math.sin(Math.PI/4)*i;n.bottom=`${r}px`,n.left=`${r}px`}}}function v(s,e){function t(){s.nodes().forEach(n=>{const o=n.renderedPosition();let i=document.getElementById(`box-${n.id()}`);i||(i=document.createElement("div"),i.id=`box-${n.id()}`,i.style.position="absolute",e.appendChild(i)),i.style.left=`${o.x}px`,i.style.top=`${o.y}px`})}t(),s.on("position","node",t),s.on("pan zoom",t),window.addEventListener("resize",t)}const N={props:{displayOnlyOnHover:!0},boxLabels:{displayOnlyOnHover:!1}};function B(s,e,t=N){v(s,e);function n(){s.nodes().forEach(o=>{const i=o.renderedBoundingBox().h,r=document.getElementById(`box-${o.id()}`);if(!r)return;const d=o.data().boxLabels;if(d!==void 0){let a=document.getElementById(`labels-box-${o.id()}`);a?a.style.bottom=`${i/2-10}px`:(a=document.createElement("div"),a.id=`labels-box-${o.id()}`,a.className="box-label",a.style.bottom=`${i/2-10}px`,t.boxLabels.displayOnlyOnHover&&(a.style.display="none"),r.appendChild(a),d.forEach((c,p)=>{if(!a)return;const u=document.createElement("div");u.id=`labels-box-${o.id()}-${p}`,u.className="entry",u.innerHTML=c,a.appendChild(u)}))}const l=o.data().properties;if(l!==void 0){let a=document.getElementById(`props-box-${o.id()}`);a?a.style.top=`${i/2-10}px`:(a=document.createElement("div"),a.id=`props-box-${o.id()}`,a.style.right="0px",a.className="property",a.style.top=`${i/2-10}px`,t.props.displayOnlyOnHover&&(a.style.display="none"),r.appendChild(a),Object.keys(l).forEach((c,p)=>{if(!a)return;const u=document.createElement("div");u.id=`props-box-${o.id()}-${p}`,u.className="entry",u.innerHTML=`<span class="key">${c}</span><span class="value">${l[c]}</span>`,a.appendChild(u)}))}})}n(),s.on("zoom",n),s.on("mouseover","node",o=>{const i=o.target;if(t.props.displayOnlyOnHover){const r=document.getElementById(`props-box-${i.id()}`);r&&(r.style.display="flex")}if(t.boxLabels.displayOnlyOnHover){const r=document.getElementById(`labels-box-${i.id()}`);r&&(r.style.display="flex")}}),s.on("mouseout","node",o=>{const i=o.target;if(t.props.displayOnlyOnHover){const r=document.getElementById(`props-box-${i.id()}`);r&&(r.style.display="none")}if(t.boxLabels.displayOnlyOnHover){const r=document.getElementById(`labels-box-${i.id()}`);r&&(r.style.display="none")}})}function H(s,e,t){v(s,e);let n=!1;function o(d){const l=document.createElement("div");l.id=`${t.id}-${d.id()}`,l.classList.add("node-menu"),l.classList.add(t.id),l.addEventListener("mouseover",()=>n=!0),l.addEventListener("mouseout",()=>n=!1),t.items.forEach(c=>{const p=document.createElement("div");l.appendChild(p),p.innerText=c.icon,p.addEventListener("click",u=>{u.preventDefault(),u.stopImmediatePropagation(),c.click(d)}),p.classList.add("entry"),p.classList.add("material-icons")});const a=document.getElementById(`box-${d.id()}`);return t.positionDef(d,l.style),a&&a.appendChild(l),l}function i(d){let l=document.getElementById(`${t.id}-${d.id()}`);l||(l=o(d)),l.style.display="flex"}function r(d){const l=document.getElementById(`${t.id}-${d.id()}`);l&&(l.style.display="none")}t.sticky?s.nodes().forEach(d=>{t.conditionalDisplay(d)&&i(d)}):s.on("mouseover","node",d=>{if(!t.conditionalDisplay(d.target))return;i(d.target);const l=setInterval(()=>{n||(r(d.target),clearInterval(l))},t.hideAfter)})}exports.FileDropHandler=$;exports.NodeMenuSettings=C;exports.animateGraph=g;exports.appendHTMLLabels=B;exports.appendHostContainers=v;exports.appendNodeMenu=H;exports.buildStyles=O;exports.defaultSettings=f;exports.layout=M;exports.logNodePositions=w;
