"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function L(s,e=!0,t=1e-4,o=.02){let n=0;function r(){s.nodes().forEach((d,a)=>{const l=d.position(),u=Math.sin(performance.now()*t+a)*o,p=Math.cos(performance.now()*t+a)*o;d.position({x:l.x+u,y:l.y+p})}),n=requestAnimationFrame(r)}n=requestAnimationFrame(r);let i=!0;return e&&i&&s.on("mouseover","node",()=>{cancelAnimationFrame(n),i=!1}),n}var x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},E={},h={};Object.defineProperty(h,"__esModule",{value:!0});function $(s){return s}h.asTypedEventEmitter=$;var v={},O=x&&x.__spreadArrays||function(){for(var s=0,e=0,t=arguments.length;e<t;e++)s+=arguments[e].length;for(var o=Array(s),n=0,e=0;e<t;e++)for(var r=arguments[e],i=0,d=r.length;i<d;i++,n++)o[n]=r[i];return o};Object.defineProperty(v,"__esModule",{value:!0});var w=function(){function s(){var e=this;this.events={},this.maxListeners=1/0,this.emit=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];if(e.events[t]){for(var r=e.events[t].length,i=Array.from(e.events[t]),d=0,a=i;d<a.length;d++){var l=a[d];l.apply(void 0,o)}return!!r}return!1},this.on=function(t,o){return e.addListener(t,o),e},this.once=function(t,o){var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o.apply(void 0,r),e.removeListener(t,n)};return e.addListener(t,n),e},this.addListener=function(t,o){return t in e.events?e.events[t].push(o):e.events[t]=[o],e.maxListeners!==1/0&&e.maxListeners<=e.events[t].length&&console.warn('Maximum event listeners for "'+t+'" event!'),e},this.removeListener=function(t,o){if(t in e.events){var n=e.events[t].indexOf(o);n!==-1&&e.events[t].splice(n,1)}return e},this.hasListeners=function(t){return e.events[t]&&!!e.events[t].length},this.prependListener=function(t,o){return t in e.events?e.events[t].unshift(o):e.events[t]=[o],e},this.prependOnceListener=function(t,o){var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o.apply(void 0,r),e.removeListener(t,n)};return e.prependListener(t,n),e},this.off=function(t,o){return e.removeListener(t,o)},this.removeAllListeners=function(t){return delete e.events[t],e},this.setMaxListeners=function(t){return e.maxListeners=t,e},this.getMaxListeners=function(){return e.maxListeners},this.listeners=function(t){return O(e.events[t])},this.rawListeners=function(t){return e.events[t]},this.eventNames=function(){return Object.keys(e.events)},this.listenerCount=function(t){return e.events[t]&&e.events[t].length||0}}return s}();v.EventEmitter=w;(function(s){function e(t){for(var o in t)s.hasOwnProperty(o)||(s[o]=t[o])}Object.defineProperty(s,"__esModule",{value:!0}),e(h),e(v)})(E);class C{constructor(e){this._cy=e,this.events=new E.EventEmitter,this._initEventListeners()}_initEventListeners(){var e,t;(e=this._cy.container())==null||e.addEventListener("dragover",o=>{o.preventDefault(),o.stopPropagation();const n=this._getClosestNode(o);n===void 0&&this._lastHoveredNode!==void 0?this.events.emit("fileOverNodeEnd",this._lastHoveredNode):this._lastHoveredNode!==n&&n!==void 0&&this.events.emit("fileOverNodeStart",n),this._lastHoveredNode=n}),(t=this._cy.container())==null||t.addEventListener("drop",o=>{var r;o.preventDefault(),o.stopPropagation();const n=this._getClosestNode(o);if(n!==void 0){const i=(r=o.dataTransfer)==null?void 0:r.files;i!==void 0&&this.events.emit("filesDroppedOnNode",n,i)}})}_getClosestNode(e,t=20){var d,a;if(((d=this._cy)==null?void 0:d.nodes())===void 0)return;const n={x:e.offsetX,y:e.offsetY};let r,i=t;return(a=this._cy)==null||a.nodes().forEach(l=>{const u=this._distance(n,l.renderedPosition());u<i&&(i=u,r=l)}),r}_distance(e,t){const o=t.x-e.x,n=t.y-e.y;return Math.sqrt(o*o+n*n)}}const m={backgroundColor:"#fff",edgeColor:"#0d5be9",edgeFontSize:"5rem",edgeWidth:"3rem",nodeColor:"#03337a",nodeOpacity:"0.9",font:"Poppins",directed:!0},M=(s=m)=>[{selector:"node",style:{label:e=>e.data("label")?e.data("label"):"","text-valign":"center","font-family":s.font,"font-size":"10rem",opacity:s.nodeOpacity,color:"white","text-outline-color":e=>e.data("color")?e.data("color"):s.nodeColor,"text-outline-width":1,"background-color":e=>e.data("color")?e.data("color"):s.nodeColor,width:e=>e.data("size")?e.data("size"):"",height:e=>e.data("size")?e.data("size"):""}},{selector:"edge",style:{label:"data(label)","text-valign":"center","font-family":s.font,"font-size":s.edgeFontSize,color:s.edgeColor,"target-arrow-color":s.edgeColor,"curve-style":"bezier","target-arrow-shape":s.directed?"triangle":"none","line-color":s.edgeColor,width:e=>e.data("width")?e.data("width"):s.edgeWidth,"text-rotation":"autorotate","text-background-opacity":1,"text-background-color":s.backgroundColor,"text-background-padding":4}},{selector:".triple",style:{"background-color":"white","border-color":e=>e.data("color")?e.data("color"):s.nodeColor}},{selector:".literal",style:{shape:"rectangle",width:"label",height:"label",label:e=>e.data("label")?e.data("label"):"",padding:"2rem","border-color":"black","border-width":.3,"background-color":"white","text-outline-width":0,color:"black"}},{selector:".loading",style:{"pie-size":"100%","pie-1-background-color":m.nodeColor,"pie-1-background-size":e=>`${e.data("pct")}%`,"pie-2-background-color":m.edgeColor,"pie-2-background-size":e=>`${100-parseInt(e.data("pct"))}%`,label:e=>`${e.data("pct")}%`,"font-size":"5rem"}}],B={name:"grid",padding:100};function N(s){s.on("dragfree","node",e),s.on("viewport",e);function e(){const t=s.json(),o=[];t.elements.nodes.forEach(n=>{const r={};r.data=n.data,r.position={x:Math.round(n.position.x),y:Math.round(n.position.y)},n.classes&&(r.classes=n.classes),o.push(r)}),console.log(o)}}function y(s,e){function t(){s.nodes().forEach(o=>{const n=o.renderedPosition();let r=document.getElementById(`box-${o.id()}`);r||(r=document.createElement("div"),r.id=`box-${o.id()}`,r.style.position="absolute",e.appendChild(r)),r.style.left=`${n.x}px`,r.style.top=`${n.y}px`})}t(),s.on("position","node",t),s.on("pan zoom",t),window.addEventListener("resize",t)}const H={props:{displayOnlyOnHover:!0},boxLabels:{displayOnlyOnHover:!1}};function I(s,e,t=H){y(s,e);function o(){s.nodes().forEach(n=>{const r=n.renderedBoundingBox().h,i=document.getElementById(`box-${n.id()}`);if(!i)return;const d=n.data().boxLabels;if(d!==void 0){let l=document.getElementById(`labels-box-${n.id()}`);l?l.style.bottom=`${r/2-10}px`:(l=document.createElement("div"),l.id=`labels-box-${n.id()}`,l.className="box-label",l.style.bottom=`${r/2-10}px`,t.boxLabels.displayOnlyOnHover&&(l.style.display="none"),i.appendChild(l),d.forEach((u,p)=>{if(!l)return;const c=document.createElement("div");c.id=`labels-box-${n.id()}-${p}`,c.className="entry",c.innerHTML=u,l.appendChild(c)}))}const a=n.data().properties;if(a!==void 0){let l=document.getElementById(`props-box-${n.id()}`);l?l.style.top=`${r/2-10}px`:(l=document.createElement("div"),l.id=`props-box-${n.id()}`,l.style.right="0px",l.className="property",l.style.top=`${r/2-10}px`,t.props.displayOnlyOnHover&&(l.style.display="none"),i.appendChild(l),Object.keys(a).forEach((u,p)=>{if(!l)return;const c=document.createElement("div");c.id=`props-box-${n.id()}-${p}`,c.className="entry",c.innerHTML=`<span class="key">${u}</span><span class="value">${a[u]}</span>`,l.appendChild(c)}))}})}o(),s.on("zoom",o),s.on("mouseover","node",n=>{const r=n.target;if(t.props.displayOnlyOnHover){const i=document.getElementById(`props-box-${r.id()}`);i&&(i.style.display="flex")}if(t.boxLabels.displayOnlyOnHover){const i=document.getElementById(`labels-box-${r.id()}`);i&&(i.style.display="flex")}}),s.on("mouseout","node",n=>{const r=n.target;if(t.props.displayOnlyOnHover){const i=document.getElementById(`props-box-${r.id()}`);i&&(i.style.display="none")}if(t.boxLabels.displayOnlyOnHover){const i=document.getElementById(`labels-box-${r.id()}`);i&&(i.style.display="none")}})}function z(s,e,t){y(s,e);let o=!1;function n(d){const a=document.createElement("div");a.id=`node-menu-${d.id()}`,a.classList.add("node-menu"),a.addEventListener("mouseover",()=>o=!0),a.addEventListener("mouseout",()=>o=!1),t.forEach(g=>{const f=document.createElement("div");a.appendChild(f),f.innerText=g.icon,f.addEventListener("click",b=>{b.preventDefault(),b.stopImmediatePropagation(),g.click(d)}),f.classList.add("entry"),f.classList.add("material-icons")});const u=d.renderedBoundingBox().h/2,p=Math.sin(Math.PI/4)*u,c=document.getElementById(`box-${d.id()}`);return a.style.bottom=`${p}px`,a.style.left=`${p}px`,c&&c.appendChild(a),a}function r(d){console.log(d);let a=document.getElementById(`node-menu-${d.id()}`);a||(a=n(d)),a.style.display="flex"}function i(d){const a=document.getElementById(`node-menu-${d.id()}`);a&&(a.style.display="none")}s.on("mouseover","node",d=>{console.log(d),r(d.target);const a=setInterval(()=>{o||(i(d.target),clearInterval(a))},2e3)})}exports.FileDropHandler=C;exports.animateGraph=L;exports.appendHTMLLabels=I;exports.appendHostContainers=y;exports.appendNodeMenu=z;exports.buildStyles=M;exports.defaultSettings=m;exports.layout=B;exports.logNodePositions=N;
